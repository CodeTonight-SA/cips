{
  "repeated-file-reads": {
    "description": "Reading same file multiple times without user edits",
    "regex": "(Read tool|Read\\(|read file).*\\b(package\\.json|tsconfig\\.json|CLAUDE\\.md|SKILL\\.md)\\b",
    "threshold": 3,
    "severity": "major",
    "points": 10,
    "impact_per_occurrence": "500-2000 tokens wasted",
    "remediation": "Check conversation buffer before Read. Trust mental model after first read. See CLAUDE.md Rule 1: File Read Optimization Protocol.",
    "skill_suggestion": "file-read-optimizer"
  },
  "temp-script-creation": {
    "description": "Creating temporary scripts for simple batch operations",
    "regex": "(Write|create|creating).*\\.(js|py|sh)\\b.*(temp|tmp|script|extract|transform)",
    "threshold": 2,
    "severity": "major",
    "points": 10,
    "impact_per_occurrence": "3000-8000 tokens vs 500 direct",
    "remediation": "Use MultiEdit or single CLI command (rg | xargs sed) instead",
    "skill_suggestion": "direct-implementation-enforcer"
  },
  "node-modules-read": {
    "description": "Reading from node_modules or dependency folders",
    "regex": "(Read|cat|bat|head|tail|less|more).*/(node_modules|venv|\\.venv|dist|build|__pycache__)/",
    "threshold": 1,
    "severity": "critical",
    "points": 50,
    "impact_per_occurrence": "50000+ tokens wasted",
    "remediation": "Always use --glob '!node_modules/*' --exclude venv flags. See CLAUDE.md PARAMOUNT RULE: Never Read Dependency/Build Folders.",
    "skill_suggestion": "dependency-guardian",
    "note": "Updated 2025-12-03: Regex now requires read command + path, avoiding false positives from exclusion patterns"
  },
  "individual-edits": {
    "description": "Multiple individual Edit calls instead of batch MultiEdit",
    "regex": "Edit\\(|Edit tool",
    "threshold": 6,
    "severity": "major",
    "points": 10,
    "impact_per_occurrence": "500 per file vs 800 batch",
    "remediation": "Use MultiEdit for 3+ related file changes",
    "skill_suggestion": "batch-edit-enforcer"
  },
  "unnecessary-preambles": {
    "description": "Starting responses with 'I'll now' or 'Let me'",
    "regex": "(I'll now|I will now|Let me|I'm going to|First, I'll)",
    "threshold": 5,
    "severity": "minor",
    "points": 3,
    "impact_per_occurrence": "50-200 tokens per instance",
    "remediation": "Start with action, skip announcements. See CLAUDE.md Rule 4: Concise by Default.",
    "skill_suggestion": "concise-communication"
  },
  "unnecessary-postambles": {
    "description": "Ending responses with summaries of what was just done",
    "regex": "(In summary|To summarize|I have completed|I've finished|Done\\.|Successfully completed)",
    "threshold": 5,
    "severity": "minor",
    "points": 3,
    "impact_per_occurrence": "100-300 tokens per instance",
    "remediation": "End when action completes, no summary needed. See CLAUDE.md Rule 4: Concise by Default.",
    "skill_suggestion": "concise-communication"
  },
  "grep-instead-of-rg": {
    "description": "Using grep instead of ripgrep (rg)",
    "regex": "\\bgrep\\b(?!.*rg)",
    "threshold": 2,
    "severity": "minor",
    "points": 5,
    "impact_per_occurrence": "Slower, may miss exclusions",
    "remediation": "Always use rg with proper --glob exclusions",
    "skill_suggestion": "bash-tool-enforcer"
  },
  "find-instead-of-fd": {
    "description": "Using find instead of fd",
    "regex": "\\bfind\\b(?!.*fd)",
    "threshold": 2,
    "severity": "minor",
    "points": 5,
    "impact_per_occurrence": "Slower, verbose syntax",
    "remediation": "Always use fd with --exclude flags",
    "skill_suggestion": "bash-tool-enforcer"
  },
  "unnecessary-plan-execution": {
    "description": "Executing plan items that don't improve code",
    "regex": "(extract|refactor|create interface|modularize).*(?=already|exists|optimal)",
    "threshold": 2,
    "severity": "major",
    "points": 10,
    "impact_per_occurrence": "5000-10000 tokens wasted",
    "remediation": "Evaluate plan items before execution, propose skip if code satisfies",
    "skill_suggestion": "plan-evaluation-gate"
  },
  "multi-tool-instead-of-cli": {
    "description": "Multiple tool calls when single CLI command suffices",
    "regex": "(Read.*){3,}|(?:Edit.*){3,}",
    "threshold": 2,
    "severity": "major",
    "points": 10,
    "impact_per_occurrence": "1000-3000 tokens saved with CLI",
    "remediation": "Use rg | xargs sed, fd | xargs, or similar bulk operations",
    "skill_suggestion": "cli-bulk-operations"
  },
  "arbitrary-line-count-filtering": {
    "description": "Using arbitrary line counts (tail -n 500) instead of timestamp-based filtering for temporal analysis",
    "regex": "(tail -n \\d+|head -n \\d+).*history\\.jsonl(?!.*timestamp)",
    "threshold": 2,
    "severity": "minor",
    "points": 5,
    "impact_per_occurrence": "Imprecise temporal windows, potential stale data analysis",
    "remediation": "Use tail + jq timestamp filtering: tail -n 1000 history.jsonl | jq 'select(.timestamp >= START and .timestamp <= END)'",
    "skill_suggestion": "timestamp-based-analysis"
  },
  "context-loss": {
    "description": "Re-reading project docs (CLAUDE.md, README.md) within same session - indicates missing context refresh at session start",
    "regex": "Read\\((CLAUDE\\.md|README\\.md)\\).*Read\\(\\1\\)|read (CLAUDE\\.md|README\\.md).*read \\1",
    "threshold": 2,
    "severity": "major",
    "points": 10,
    "impact_per_occurrence": "2000-5000 tokens wasted on repeated context establishment",
    "remediation": "Use /refresh-context at session start. Cache project docs in mental model after first read.",
    "skill_suggestion": "context-refresh"
  },
  "grep-usage-in-scripts": {
    "description": "Using grep in bash scripts instead of rg (ripgrep)",
    "regex": "\\bgrep\\s+-[a-zA-Z]+",
    "threshold": 1,
    "severity": "minor",
    "points": 5,
    "impact_per_occurrence": "10-100x slower than rg, regex compatibility issues",
    "remediation": "Replace all grep with rg (ripgrep). See CLAUDE.md Core Bash Tools section.",
    "skill_suggestion": "bash-tool-enforcer"
  },
  "premature-feature-building": {
    "description": "Implementing features before they are actually needed or requested",
    "regex": "(build|implement|add).*feature.*(future|might|maybe|just in case|when we need)",
    "threshold": 2,
    "severity": "major",
    "points": 10,
    "impact_per_occurrence": "2000-10000 tokens wasted on speculative code",
    "remediation": "Apply YAGNI: only build features when actually needed. See yagni-principle skill.",
    "skill_suggestion": "yagni-principle"
  },
  "speculative-abstraction": {
    "description": "Creating abstractions or interfaces for hypothetical future use cases",
    "regex": "(interface|abstract|generic).*\\b(future|potential|might|in case|when we)",
    "threshold": 2,
    "severity": "major",
    "points": 10,
    "impact_per_occurrence": "3000-8000 tokens on unused abstractions",
    "remediation": "Add abstractions when 2nd implementation exists, not 'just in case'. Apply YAGNI + DRY Rule of Three.",
    "skill_suggestion": "yagni-principle"
  },
  "readonly-redeclaration": {
    "description": "Readonly variable declaration in sourceable script without guard - causes error on re-source",
    "regex": "^\\s*readonly\\s+[A-Z_]+=",
    "context_required": "lib/|hooks/",
    "threshold": 1,
    "severity": "major",
    "points": 10,
    "impact_per_occurrence": "Script fails completely on re-source with 'readonly variable' error",
    "remediation": "Use guard pattern: [[ -z \"${VAR:-}\" ]] && readonly VAR=value. See lib/bash-linter.sh for detection.",
    "skill_suggestion": "bash-source-safety",
    "auto_detected": true,
    "first_occurrence": "2025-12-01T20:30:00Z",
    "files_affected": ["lib/orchestrator.sh", "lib/path-resolver.sh", "lib/command-executor.sh", "hooks/session-start.sh", "hooks/tool-monitor.sh"]
  },
  "unused-configuration": {
    "description": "Adding configuration options for features that don't exist yet",
    "regex": "(config|setting|feature.?flag|option).*\\b(todo|future|planned|upcoming|not.*implement)",
    "threshold": 3,
    "severity": "minor",
    "points": 5,
    "impact_per_occurrence": "500-2000 tokens maintaining dead config",
    "remediation": "Only add config for features that currently exist. Remove config when feature removed.",
    "skill_suggestion": "yagni-principle"
  },
  "semicolon-after-subshell": {
    "description": "Using semicolon after command substitution causes parse error in eval contexts",
    "regex": "\\$\\([^)]+\\)\\s*;",
    "threshold": 1,
    "severity": "major",
    "points": 10,
    "impact_per_occurrence": "Script fails with 'parse error near )' in eval/hook contexts",
    "remediation": "Use && instead of ; after $(cmd). Example: VAR=$(cmd) && echo $VAR",
    "skill_suggestion": "bash-command-safety",
    "auto_detected": true,
    "first_occurrence": "2025-12-01T21:00:00Z"
  },
  "path-encoding-missing-caret": {
    "description": "Path encoding without removing leading slash creates dash-prefixed strings",
    "regex": "sed.*s\\|/?\\|-\\|g(?!.*\\^/)",
    "threshold": 1,
    "severity": "major",
    "points": 10,
    "impact_per_occurrence": "Creates -Users-foo which fd/find interpret as flag, causing 'unexpected argument' errors",
    "remediation": "Add s|^/|| BEFORE s|/|-|g. Example: sed 's|^/||; s|/|-|g'",
    "skill_suggestion": "bash-path-encoding",
    "auto_detected": true,
    "first_occurrence": "2025-12-01T21:00:00Z"
  },
  "fd-missing-double-dash": {
    "description": "fd/find/rg without -- before variable path that may start with dash",
    "regex": "(fd|find|rg)\\s+-[a-z]+.*\\$[A-Z_]+(?!.*--\\s)",
    "threshold": 1,
    "severity": "major",
    "points": 10,
    "impact_per_occurrence": "Dash-prefixed paths interpreted as flags: 'unexpected argument -U'",
    "remediation": "Add -- before path variable to end flag parsing. Example: fd -t d -- \"$path\"",
    "skill_suggestion": "bash-command-safety",
    "auto_detected": true,
    "first_occurrence": "2025-12-01T21:00:00Z"
  },
  "documentation-drift": {
    "description": "Many commits without documentation updates",
    "regex": "git log.*--since.*(7|14) days.*\\b([1-9][0-9]+|[5-9])\\b.*commits",
    "threshold": 1,
    "severity": "medium",
    "points": 8,
    "impact_per_occurrence": "Documentation falls behind reality, new sessions get stale context",
    "remediation": "Run /update-docs to synchronise documentation with actual state",
    "skill_suggestion": "auto-update-documentation",
    "auto_detected": false,
    "first_occurrence": "2025-12-03T00:00:00Z"
  }
}
